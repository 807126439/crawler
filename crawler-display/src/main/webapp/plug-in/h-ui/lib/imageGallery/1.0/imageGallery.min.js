function imageGallery(t){var e={first:0,target:"",list:"",title:"",prev:"",next:"",count:"",total:"",leftSlide:"",rightSlide:"",slideBack:"",srcattr:"data-src",titleattr:"title",speed:1,startToEnd:true,endToStart:true,listenKey:true};var i=$.extend({},e,t);var n=$(i.target),l=$(i.list),r=$(i.title),a=$(i.prev),f=$(i.next),o=$(i.count),c=$(i.total),s=$(i.leftSlide),d=$(i.rightSlide),u=$(i.slideBack);var x=l.find("li").length;c.text(x);l.css({width:"10000px",position:"relative"});f.on("click",p);a.on("click",v);l.find("li img").on("click",k);s.on("click",T);d.on("click",S);u.on("click",F);if(i.listenKey){$(document).on("keydown",g)}h(i.first);function g(t){var e=t.keyCode;if(e==37){v()}else if(e==39){p()}}function p(){var t=l.find("li.selected").index();if(t+1===x){if(i.endToStart){z();return}}else{h(t+1)}}function v(){var t=l.find("li.selected").index();if(t===0){if(i.startToEnd){q();return}}else{h(t-1)}}function k(){var t=$(this).closest("li").index();h(t)}function h(t){var e=l.find("li:eq("+t+") img");o.text(t+1);e.closest("li").addClass("selected").siblings().removeClass("selected");if(i.titleattr.indexOf("data-")!==-1){r.text(e.data(i.titleattr.substring(5)))}else{r.text(e.attr(i.titleattr))}if(i.srcattr.indexOf("data-")!==-1){n.attr("src",e.data(i.srcattr.substring(5)))}else{n.attr("src",e.attr(i.srcattr))}m();y(t)}function m(t,e){var n=l.find("li.selected").index();setTimeout(function(){if(l.find("li.selected").index()!==n){return}if(n+1!==x){if(i.srcattr.indexOf("data-")!==-1){b(l.find("li").eq(n+1).data(i.srcattr.substring(5)))}else{b(l.find("li").eq(n+1).attr(i.srcattr))}}if(n!==0){if(i.srcattr.indexOf("data-")!==-1){b(l.find("li").eq(n-1).data(i.srcattr.substring(5)))}else{b(l.find("li").eq(n-1).attr(i.srcattr))}}},1200)}function b(t,e){var i=$("<img>").on("load",function(){e.call(i)});i.attr("src",t)}function y(t,e){var n=w(t),r;if(n>0){r=0}else{r=n}l.animate({left:r+"px"},i.speed*600,e)}function w(t){var e=l.find("li:eq("+t+") img"),i=e.offset().left,n=l.offset().left,r=e.width(),a=l.parent().width();centerMargin=(a-r)/2;var f=n+centerMargin-i;return f}function T(){var t=l.css("left")==="auto"?0:parseInt(l.css("left")),e=l.parent().width();var n=t+e/2;if(n>0){resultLeft=0}else{resultLeft=n}l.animate({left:resultLeft+"px"},i.speed*600)}function S(){var t=l.css("left")==="auto"?0:parseInt(l.css("left")),e=l.parent().width();var n=t-e/2,r=w(l.find("li").length-1);if(n<r){resultLeft=r}else{resultLeft=n}l.animate({left:resultLeft+"px"},i.speed*600)}function F(){var t=l.find("li.selected").index();y(t,function(){l.find("li.selected img").animate({opacity:.5},function(){l.find("li.selected img").animate({opacity:1})})})}function q(){L("startToEnd")}function z(){L("endToStart")}function L(t){var e=$('<div style="position:fixed;width:300px;height:100px;color:#FFF;background:#333;font-size:16px;z-index:2000;left:50%;top:50%;margin-left:-150px;margin-top:-50px;text-align:center;line-height:50px;"><div class="ct"></div><div class="ft"></div>'),i=$('<a href="javascript:void(0)" style="color:#FFF;display:inline-block;width:50%;float:left;text-align:center;background:#444;"></a>'),n=$('<a href="javascript:void(0)" style="color:#FFF;display:inline-block;width:50%;float:left;text-align:center;background:#444;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;border-left:1px solid #333;">返回</a>');e.find(".ft").append(i).append(n);e.appendTo($("body"));if(t==="startToEnd"){i.text("前往最后一页");e.find(".ct").text("已经到达第一页");i.on("click",function(){h(x-1);l()})}else if(t==="endToStart"){i.text("前往第一页");e.find(".ct").text("已经到达最后一页");i.on("click",function(){h(0);l()})}n.on("click",l);function l(){i.off();n.off();e.remove()}}return{getCounts:function(){return x},showNext:p,showPrev:v,showImage:h,slideToImage:y,leftSlide:T,rightSlide:S,slideBack:F,destroy:function(){f.off("click",p);a.off("click",v);l.find("li img").off("click",k);s.off("click",T);d.off("click",S);u.off("click",F);$(document).off("keydown",g);n=null,l=null,r=null,a=null,f=null,o=null,c=null,s=null,d=null,u=null;x=null}}}